To get the history of all the pipelines in your AWS account, you can modify the previous program to iterate over all the pipelines and retrieve their history one by one. Here's an updated version of the program:

```python
import boto3
from openpyxl import Workbook

def get_all_pipelines():
    client = boto3.client('codepipeline')
    response = client.list_pipelines()
    return response['pipelines']

def get_pipeline_history(pipeline_name):
    client = boto3.client('codepipeline')
    response = client.list_pipeline_executions(pipelineName=pipeline_name)
    return response['pipelineExecutionSummaries']

def get_pipeline_execution_details(pipeline_name, execution_id):
    client = boto3.client('codepipeline')
    response = client.get_pipeline_execution(
        pipelineName=pipeline_name,
        pipelineExecutionId=execution_id
    )
    return response['pipelineExecution']

def write_to_excel(pipeline_name, history, ws):
    for execution in history:
        execution_id = execution['pipelineExecutionId']
        status = execution['status']
        start_time = execution['startTime']
        end_time = execution['lastUpdateTime']

        execution_details = get_pipeline_execution_details(pipeline_name, execution_id)
        stages = execution_details['pipelineExecution']['artifactRevisions']

        for stage in stages:
            stage_name = stage['revisionId']['name']
            stage_status = stage['status']
            stage_start_time = stage['created']
            stage_end_time = stage['lastUpdated']

            ws.append([pipeline_name, execution_id, status, start_time, end_time, stage_name, stage_status, stage_start_time, stage_end_time])

def main():
    pipelines = get_all_pipelines()

    wb = Workbook()
    ws = wb.active
    ws.append(['Pipeline Name', 'Execution ID', 'Status', 'Start Time', 'End Time', 'Stage Name', 'Status', 'Start Time', 'End Time'])

    for pipeline in pipelines:
        pipeline_name = pipeline['name']
        history = get_pipeline_history(pipeline_name)
        write_to_excel(pipeline_name, history, ws)

    wb.save('pipeline_history.xlsx')

if __name__ == '__main__':
    main()
```

This updated program will retrieve the list of all pipelines in your AWS account and then iterate over each pipeline to retrieve its execution history. The history for each pipeline will be written to the Excel file, including the pipeline name as an additional column. The Excel file will have the same columns as before: Pipeline Name, Execution ID, Status, Start Time, End Time, Stage Name, Stage Status, Stage Start Time, and Stage End Time.

Make sure you have the `boto3` and `openpyxl` libraries installed (`pip install boto3 openpyxl`) and have configured your AWS credentials using the AWS CLI or environment 



