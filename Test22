To connect to a Windows share using PowerShell in a Jenkins pipeline with an Ubuntu agent, you can use the New-PSDrive cmdlet to create a PSDrive that maps to the Windows share. Here's an example of how you can do this:

groovy pipeline {     agent {         label 'ubuntu'     }     stages {         stage('Connect to Windows Share') {             steps {                 script {                     def username = 'your_username'                     def password = 'your_password'                     def sharePath = '\\server\share'                     def driveLetter = 'Z'                      // Create a PSDrive to map to the Windows share                     powershell """                     \$password = ConvertTo-SecureString -String '${password}' -AsPlainText -Force                     \$credentials = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList '${username}', \$password                     New-PSDrive -Name '${driveLetter}' -PSProvider FileSystem -Root '${sharePath}' -Credential \$credentials                     """                                          // Use the mapped drive to perform operations on the Windows share                     powershell """                     # Example: List files in the Windows share                     Get-ChildItem -Path '${driveLetter}:' | Select-Object -Property Name                     """                 }             }         }     } } 

Make sure to replace 'your_username', 'your_password', '\\server\share', and 'Z' with the appropriate values for your setup.

This pipeline uses the powershell step to execute PowerShell commands on the Ubuntu agent. The first powershell step creates a PSDrive using the provided username, password, share path, and drive letter. The second powershell step demonstrates how you can use the mapped drive to perform operations on the Windows share. You can modify the second powershell step to perform the specific operations you need on the Windows share.
